<!-- Page Wrapper -->
<div id="wrapper">

    <!-- Sidebar -->
    <ul class="navbar-nav bg-gradient-dark  sidebar sidebar-dark accordion" id="accordionSidebar">
        <div class="raw">
            <!-- Sidebar - Brand -->
            <a class="navbar-brand" href="#"></a>

            <div class="logo-image">
                <img src="{% static 'images/infoda_logo.jpg' %}" class="img-fluid">
                <img src="#" class="img-fluid">
            </div>

            </a>
            <div class="sidebar-brand-text"></div>
        </div>

        <!-- Divider -->
        <hr class="sidebar-divider my-0">

        <!-- Nav Item - Dashboard -->
        <li class="nav-item">
            <a class="nav-link" href="index.html">
                <i class="fas fa-fw fa-tachometer-alt"></i>
                <span>Dashboard</span></a>
        </li>

        <!-- Divider -->
        <hr class="sidebar-divider">

        <!-- Heading -->
        <div class="sidebar-heading">
            Interface
        </div>

        <!-- Nav Item - Pages Collapse Menu -->
        <li class="nav-item">
            <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwo"
                aria-expanded="true" aria-controls="collapseTwo">
                <i class="fas fa-fw fa-cog"></i>
                <span>Components</span>
            </a>
            <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar">
                <div class="bg-white py-2 collapse-inner rounded">
                    <h6 class="collapse-header">Custom Components:</h6>
                    <a class="collapse-item" href="buttons.html">Buttons</a>
                    <a class="collapse-item" href="cards.html">Cards</a>
                </div>
            </div>
        </li>

        <!-- Nav Item - Utilities Collapse Menu -->
        <li class="nav-item">
            <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseUtilities"
                aria-expanded="true" aria-controls="collapseUtilities">
                <i class="fas fa-fw fa-wrench"></i>
                <span>Utilities</span>
            </a>
            <div id="collapseUtilities" class="collapse" aria-labelledby="headingUtilities"
                data-parent="#accordionSidebar">
                <div class="bg-white py-2 collapse-inner rounded">
                    <h6 class="collapse-header">Custom Utilities:</h6>
                    <a class="collapse-item" href="utilities-color.html">Colors</a>
                    <a class="collapse-item" href="utilities-border.html">Borders</a>
                    <a class="collapse-item" href="utilities-animation.html">Animations</a>
                    <a class="collapse-item" href="utilities-other.html">Other</a>
                </div>
            </div>
        </li>

        <!-- Divider -->
        <hr class="sidebar-divider">

        <!-- Heading -->
        <div class="sidebar-heading">
            Addons
        </div>

        <!-- Nav Item - Pages Collapse Menu -->
        <li class="nav-item active">
            <a class="nav-link" href="#" data-toggle="collapse" data-target="#collapsePages" aria-expanded="true"
                aria-controls="collapsePages">
                <i class="fas fa-fw fa-folder"></i>
                <span>Pages</span>
            </a>
            <div id="collapsePages" class="collapse show" aria-labelledby="headingPages"
                data-parent="#accordionSidebar">
                <div class="bg-white py-2 collapse-inner rounded">
                    <h6 class="collapse-header">Login Screens:</h6>
                    <a class="collapse-item" href="login.html">Login</a>
                    <a class="collapse-item" href="register.html">Register</a>
                    <a class="collapse-item" href="forgot-password.html">Forgot Password</a>
                    <div class="collapse-divider"></div>
                    <h6 class="collapse-header">Other Pages:</h6>
                    <a class="collapse-item" href="404.html">404 Page</a>
                    <a class="collapse-item active" href="blank.html">Blank Page</a>
                </div>
            </div>
        </li>

        <!-- Nav Item - Charts -->
        <li class="nav-item">
            <a class="nav-link" href="charts.html">
                <i class="fas fa-fw fa-chart-area"></i>
                <span>Charts</span></a>
        </li>

        <!-- Nav Item - Tables -->
        <li class="nav-item">
            <a class="nav-link" href="tables.html">
                <i class="fas fa-fw fa-table"></i>
                <span>Tables</span></a>
        </li>

        <!-- Divider -->
        <hr class="sidebar-divider d-none d-md-block">

        <!-- Sidebar Toggler (Sidebar) -->
        <div class="text-center d-none d-md-inline">
            <button class="rounded-circle border-0" id="sidebarToggle"></button>
        </div>

    </ul>
    <!-- End of Sidebar -->

    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">

        <!-- Main Content -->
        <div id="content">

            <!-- Topbar -->
            <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">

                <!-- Sidebar Toggle (Topbar) -->


                <!-- Topbar Search -->


                <!-- Topbar Navbar -->
                <ul class="navbar-nav ml-auto">



                </ul>

            </nav>
            <!-- End of Topbar -->

            <!-- Begin Page Content -->
            <div class="container-fluid">
                {% block content %}
                {% endblock %}
                <!-- Page Heading -->


            </div>
            <!-- /.container-fluid -->

        </div>
        <!-- End of Main Content -->

        <!-- Footer -->
        <footer class="sticky-footer bg-white">
            <div class="container my-auto">
                <div class="copyright text-center my-auto">
                    <span>Copyright &copy; INFODA Smart Solution</span>
                </div>
            </div>
        </footer>
        <!-- End of Footer -->

    </div>
    <!-- End of Content Wrapper -->

</div>
<!-- End of Page Wrapper -->

<!-- call_view -->

<div class="row ">

    <!-- <section class="audio-player">
            <div id="waveform"></div>
            <div class="analysis-emojis"></div>
          </section> -->




    <div class="col-lg-6 ">
        <div id="chart"></div>

    </div>
</div>
<div class="row">

    <!-- Earnings (Monthly) Card Example -->
    <div class="col-xl-6 col-md-6 mb-4">
        <div class="card border_agent shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                            Agent</div>
                        <audio class="audio_player" id="audio" src="{{ MEDIA_URL }}/{{res_cov.ch2}}" controls></audio>

                    </div>
                    <div class="col-auto">
                        <div class="msg-img" style='background-image: url("{% static 'images/agent1.png' %}")'></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Earnings (Monthly) Card Example -->
    <div class="col-xl-6 col-md-6 mb-4">
        <div class="card border_custom shadow h-100 py-2">
            <div class="card-body">
                <div class="row no-gutters align-items-center">
                    <div class="col mr-2">
                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                            Customer</div>
                        <audio class="audio_player" id="audio" src="{{ MEDIA_URL }}/{{res_cov.ch1}}" controls></audio>

                    </div>
                    <div class="col-auto">
                        <div class="msg-img" style='background-image: url' ("{% static "images/user.png" %}")';></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="row ">
    <div class="col-lg-6 ">
        <div class="card mb-4 ">
            <section class="">
                <header class="msger-header">
                    <div class="msger-header-title">
                        <i class="fas fa-comment-alt"></i> SimpleChat
                    </div>
                    <div class="msger-header-options">
                        <span><i class="fas fa-cog"></i></span>
                    </div>
                </header>
                <div class="">
                    <i class="fa-solid fa-cutlery"></i>
                </div>
                <main class="msger-chat chat_container">
                    {% for category in res_messages %}
                    {% if category.channel == '2' %}
                    <div class="msg left-msg">
                        <div class="msg-img" style='background-image: url("{% static 'images/agent1.png' %}")'></div>





                        <div class="msg-bubble">
                            <div class="msg-info">
                                <div class="msg-info-name">Agent</div>
                                <div class="msg-info-time">{{category.start}}</div>
                            </div>

                            <div class="msg-text">
                                {{category.message}}
                            </div>

                        </div>
                        {% if category.sentance_analysis.sent_ana == 'negative' %}
                        <div class="">
                            <i class="fa fa-frown-o sad_icon" aria-hidden="true"></i>
                        </div>
                        {% elif category.sentance_analysis.sent_ana == 'positive' %}
                        <div class="">
                            <i class="fa fa-smile-o smile_icon" aria-hidden="true"></i>
                        </div>


                        {% else %}
                        <div class="">
                            <i class="fa fa-meh-o nutral_icon" aria-hidden="true"></i>
                        </div>
                        {% endif %}
                    </div>
                    {% else %}
                    <div class="msg right-msg">
                        <div class="msg-img" style='background-image: url("{% static 'images/user.png' %}")'></div>

                        <div class="msg-bubble">
                            <div class="msg-info">
                                <div class="msg-info-name">Client</div>
                                <div class="msg-info-time">{{category.start}}</div>
                            </div>

                            <div class="msg-text">
                                {{category.message}}
                            </div>


                        </div>
                        {% if category.sentance_analysis.sent_ana == 'negative' %}
                        <div class="">
                            <i class="fa fa-frown-o sad_icon" aria-hidden="true"></i>
                        </div>
                        {% elif category.sentance_analysis.sent_ana == 'positive' %}
                        <div class="">
                            <i class="fa fa-smile-o smile_icon" aria-hidden="true"></i>
                        </div>


                        {% else %}
                        <div class="">
                            <i class="fa fa-meh-o nutral_icon" aria-hidden="true"></i>
                        </div>
                        {% endif %}


                    </div>
                    {% endif %}
                    {% endfor %}
                </main>

                {% for category in res_messages %}
                {% if category.channel == '2' %}
                <div class="agent-transcription">
                    <div>
                        <p class="info">Agent {{category.start}}</p>
                        <p></p>
                    </div>
                    <div class="message-section">
                        <!-- positive message -->
                        {% if category.sentance_analysis.sent_ana == 'positive' %}
                        <div class="message positive">
                            {{category.message}}
                        </div>
                        {% elif category.sentance_analysis.sent_ana == 'negative' %}
                        <div class="message negative">
                            {{category.message}}
                        </div>
                        {% else %}
                        <div class="message">
                            {{category.message}}
                        </div>
                        {% endif %}
                        <div class="image">
                            <img src="{% static 'images/agent1.png' %}" />
                        </div>
                    </div>
                </div>
                {% else %}
                <div class="customer-transcription">
                    <div>
                        <p class="info">Client {{category.start}}</p>
                        <p></p>
                    </div>
                    <div class="message-section">
                        <div class="image">
                            <img src="{% static 'images/user.png' %}" />
                        </div>
                        <!-- positive message -->
                        {% if category.sentance_analysis.sent_ana == 'positive' %}
                        <div class="message positive">
                            {{category.message}}
                        </div>
                        {% elif category.sentance_analysis.sent_ana == 'negative' %}
                        <div class="message negative">
                            {{category.message}}
                        </div>
                        {% else %}
                        <div class="message">
                            {{category.message}}
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endif %}
                {% endfor %}

            </section>
        </div>
    </div>
</div>

<script>

    const duration = {{ audio_size }};

    const agentSlots = [{% for i in sent_ana_agent %}
    { start: { { i.start } }, analysis: '{{i.sent_ana}}' },
    {% endfor %}];

    const customerSlots = [{% for i in sent_ana_cust %}
    { start: { { i.start } }, analysis: '{{i.sent_ana}}' },
    {% endfor %}];

    // lazy loading
    // Define the options for the IntersectionObserver
    // Define the options for the IntersectionObserver
    // const options = {
    //     rootMargin: '0px',
    //     threshold: 0.1
    // };

    // // Create a new IntersectionObserver
    // const observer = new IntersectionObserver((entries, observer) => {
    //     entries.forEach(entry => {
    //         if (entry.isIntersecting) {
    //             // Load the section when it enters the viewport
    //             const audioPlayer = document.querySelector('.audio-player');
    //             audioPlayer.innerHTML = `
    //                  <div id="waveform"></div>
    //                  <div class="analysis-emojis"></div>
    //             `;

    //             // Stop observing the element
    //             observer.unobserve(entry.target);
    //         }
    //     });
    // }, options);

    // // Observe the element that contains the section
    // const sectionContainer = document.querySelector('#audio-col');
    // observer.observe(sectionContainer);


    // end of lazy loading

</script>
